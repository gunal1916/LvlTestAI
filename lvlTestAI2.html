<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>LVLTest - Men's Recovery & Growth</title>
    <style>
        /* Reset for cross-browser compatibility */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background: #0d1b2a;
            background: -webkit-linear-gradient(135deg, #0d1b2a, #1b263b);
            background: linear-gradient(135deg, #0d1b2a, #1b263b);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 15px;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-pack: center;
            -ms-flex-pack: center;
            justify-content: center;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            -webkit-box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .header {
            background: #415a77;
            background: -webkit-linear-gradient(135deg, #415a77, #778da9);
            background: linear-gradient(135deg, #415a77, #778da9);
            padding: 20px;
            text-align: center;
            border-bottom: 2px solid #e0e1dd;
            position: relative;
        }

        .header h1 {
            font-size: 28px;
            font-weight: bold;
            color: #e0e1dd;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 12px;
            color: #e0e1dd;
            margin-top: 5px;
        }

        .credits {
            position: absolute;
            bottom: 10px;
            right: 15px;
            font-size: 10px;
            color: rgba(224, 225, 221, 0.7);
        }

        .chat-container {
            height: 500px;
            overflow-y: auto;
            padding: 20px;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-orient: vertical;
            -webkit-box-direction: normal;
            -ms-flex-direction: column;
            flex-direction: column;
            gap: 15px;
            background: rgba(13, 27, 42, 0.5);
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }

        .message {
            max-width: 80%;
            padding: 12px 15px;
            border-radius: 18px;
            line-height: 1.4;
            -webkit-animation: fadeIn 0.3s ease-in;
            animation: fadeIn 0.3s ease-in;
            font-size: 14px;
            word-wrap: break-word;
        }

        @-webkit-keyframes fadeIn {
            from { opacity: 0; -webkit-transform: translateY(10px); transform: translateY(10px); }
            to { opacity: 1; -webkit-transform: translateY(0); transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; -webkit-transform: translateY(10px); transform: translateY(10px); }
            to { opacity: 1; -webkit-transform: translateY(0); transform: translateY(0); }
        }

        .user-message {
            background: #415a77;
            background: -webkit-linear-gradient(135deg, #415a77, #778da9);
            background: linear-gradient(135deg, #415a77, #778da9);
            -ms-flex-item-align: end;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
            color: #e0e1dd;
        }

        .ai-message {
            background: #1b263b;
            background: -webkit-linear-gradient(135deg, #1b263b, #415a77);
            background: linear-gradient(135deg, #1b263b, #415a77);
            -ms-flex-item-align: start;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
            border-left: 3px solid #e0e1dd;
            color: #e0e1dd;
        }

        .timestamp {
            font-size: 10px;
            opacity: 0.6;
            margin-top: 5px;
            text-align: right;
        }

        .input-area {
            padding: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            gap: 10px;
            background: rgba(27, 38, 59, 0.7);
        }

        #user-input {
            -webkit-box-flex: 1;
            -ms-flex: 1;
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.1);
            color: #e0e1dd;
            font-size: 16px; /* Prevents zoom on iOS */
            outline: none;
            -webkit-appearance: none; /* Removes inner shadow on iOS */
        }

        #user-input::-webkit-input-placeholder {
            color: #a3b1c2;
        }

        #user-input::-moz-placeholder {
            color: #a3b1c2;
        }

        #user-input:-ms-input-placeholder {
            color: #a3b1c2;
        }

        #user-input::placeholder {
            color: #a3b1c2;
        }

        #send-btn {
            background: #778da9;
            background: -webkit-linear-gradient(135deg, #778da9, #415a77);
            background: linear-gradient(135deg, #778da9, #415a77);
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            color: #e0e1dd;
            cursor: pointer;
            font-size: 18px;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            -webkit-box-pack: center;
            -ms-flex-pack: center;
            justify-content: center;
            -webkit-transition: -webkit-transform 0.2s;
            transition: -webkit-transform 0.2s;
            transition: transform 0.2s;
            transition: transform 0.2s, -webkit-transform 0.2s;
        }

        #send-btn:hover, #send-btn:active {
            -webkit-transform: scale(1.05);
            transform: scale(1.05);
            background: #415a77;
            background: -webkit-linear-gradient(135deg, #415a77, #778da9);
            background: linear-gradient(135deg, #415a77, #778da9);
        }

        .quick-actions {
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            gap: 8px;
            padding: 10px 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(27, 38, 59, 0.7);
        }

        .quick-btn {
            background: rgba(119, 141, 169, 0.2);
            border: 1px solid #778da9;
            color: #e0e1dd;
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            -webkit-transition: all 0.3s;
            transition: all 0.3s;
            -webkit-touch-callout: none; /* iOS Safari */
            -webkit-user-select: none; /* Safari */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version */
        }

        .quick-btn:hover, .quick-btn:active {
            background: #778da9;
            color: #0d1b2a;
        }

        .mission-alert {
            background: #415a77;
            background: -webkit-linear-gradient(135deg, #415a77, #778da9);
            background: linear-gradient(135deg, #415a77, #778da9);
            padding: 10px 15px;
            border-radius: 10px;
            margin: 10px 15px;
            font-size: 14px;
            text-align: center;
            -webkit-animation: pulse 2s infinite;
            animation: pulse 2s infinite;
            color: #e0e1dd;
            border: 1px solid rgba(224, 225, 221, 0.3);
        }

        @-webkit-keyframes pulse {
            0% { -webkit-transform: scale(1); transform: scale(1); }
            50% { -webkit-transform: scale(1.02); transform: scale(1.02); }
            100% { -webkit-transform: scale(1); transform: scale(1); }
        }

        @keyframes pulse {
            0% { -webkit-transform: scale(1); transform: scale(1); }
            50% { -webkit-transform: scale(1.02); transform: scale(1.02); }
            100% { -webkit-transform: scale(1); transform: scale(1); }
        }

        .typing-indicator {
            display: none;
            padding: 10px 15px;
            -ms-flex-item-align: start;
            align-self: flex-start;
        }

        .typing-dots {
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            gap: 3px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            background: #a3b1c2;
            border-radius: 50%;
            -webkit-animation: typing 1.4s infinite;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { 
            -webkit-animation-delay: 0.2s;
            animation-delay: 0.2s; 
        }
        
        .typing-dot:nth-child(3) { 
            -webkit-animation-delay: 0.4s;
            animation-delay: 0.4s; 
        }

        @-webkit-keyframes typing {
            0%, 60%, 100% { -webkit-transform: translateY(0); transform: translateY(0); }
            30% { -webkit-transform: translateY(-5px); transform: translateY(-5px); }
        }

        @keyframes typing {
            0%, 60%, 100% { -webkit-transform: translateY(0); transform: translateY(0); }
            30% { -webkit-transform: translateY(-5px); transform: translateY(-5px); }
        }

        .stats-bar {
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -ms-flex-pack: distribute;
            justify-content: space-around;
            padding: 10px 15px;
            background: rgba(27, 38, 59, 0.7);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 12px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-weight: bold;
            color: #e0e1dd;
        }

        .stat-label {
            color: #a3b1c2;
            font-size: 10px;
        }

        /* Mobile-specific optimizations */
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .container {
                border-radius: 10px;
            }
            
            .header {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .chat-container {
                height: 60vh;
                padding: 15px;
            }
            
            .message {
                font-size: 14px;
                padding: 10px 12px;
            }
            
            .input-area {
                padding: 12px;
            }
            
            #user-input {
                font-size: 16px; /* Prevents zoom on iOS */
            }
        }

        /* Prevent text selection on UI elements */
        .quick-btn, #send-btn, .stat-item {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Fix for Safari rendering issues */
        .container {
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>LVLTest</h1>
            <p>Men's Recovery & Growth Engine</p>
            <div class="credits">by Dr. Gunal P & Dr Peter Richard Stevenson</div>
        </div>

        <div class="mission-alert">
            🎯 TODAY'S MISSION: Complete 3 sets of push-ups to failure
        </div>

        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="strength-level">Level 5</div>
                <div class="stat-label">STRENGTH</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="resilience-level">Level 4</div>
                <div class="stat-label">RESILIENCE</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="focus-level">Level 6</div>
                <div class="stat-label">FOCUS</div>
            </div>
        </div>

        <div class="chat-container" id="chat-container">
            <div class="message ai-message">
                Welcome to LVLTest. I'm here to help you rebuild with direct, actionable strategies. What challenge are you facing right now?
                <div class="timestamp">Just now</div>
            </div>
        </div>

        <div class="typing-indicator" id="typing">
            <div class="typing-dots">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
        </div>

        <div class="quick-actions">
            <button class="quick-btn" onclick="quickAction('breakup')">Breakup</button>
            <button class="quick-btn" onclick="quickAction('failure')">Career Setback</button>
            <button class="quick-btn" onclick="quickAction('lonely')">Loneliness</button>
            <button class="quick-btn" onclick="quickAction('purpose')">Lost Purpose</button>
            <button class="quick-btn" onclick="quickAction('motivation')">No Motivation</button>
        </div>

        <div class="input-area">
            <input type="text" id="user-input" placeholder="Describe your situation..." onkeypress="handleKeyPress(event)">
            <button id="send-btn" onclick="sendMessage()">➤</button>
        </div>
    </div>

    <script>
        // Cross-browser compatible JavaScript
        (function() {
            'use strict';
            
            const chatContainer = document.getElementById('chat-container');
            const userInput = document.getElementById('user-input');
            const typingIndicator = document.getElementById('typing');

            // Stats elements
            const strengthLevel = document.getElementById('strength-level');
            const resilienceLevel = document.getElementById('resilience-level');
            const focusLevel = document.getElementById('focus-level');

            // Track user stats
            let userStats = {
                strength: 5,
                resilience: 4,
                focus: 6
            };

            // AI Response database
            const aiResponses = {
                breakup: [
                    "Breakups are brutal, but they're opportunities in disguise. First action: delete her photos and unfollow on social media. This is non-negotiable for your mental space.",
                    "The pain means you cared. But your value isn't determined by one person's choice. Your mission: channel that energy into physical improvement. Go lift something heavy.",
                    "Testosterone follows action. The gym is better therapy than any conversation. Your assignment: 3 sets of pull-ups to failure, then cold shower."
                ],
                failure: [
                    "Failure is data, not destiny. What did this teach you? Now, what's one small step you can take TODAY to move forward?",
                    "Successful men have failed more times than weak men have tried. Separate the event from the story. The event: a setback. The story: 'I am a failure.' Kill the story.",
                    "Your frame determines your reality. Get back to basics: 8 hours sleep, clean nutrition, daily movement. Rebuild your foundation first."
                ],
                lonely: [
                    "Loneliness is a signal to build, not to despair. Join a martial arts gym, hiking group, or volunteer. Force the interaction for 30 days.",
                    "Quality men attract community through value. What skill can you develop that would make people want to be around you? Start there today.",
                    "A man comfortable in solitude is powerful. Use this time to build your mission. The right people will be drawn to your purpose, not your neediness."
                ],
                purpose: [
                    "Purpose isn't found, it's built. What problem can you solve? What value can you create? Start small, but start today.",
                    "Your purpose is in your daily actions. What did you do TODAY to move forward? If the answer is nothing, that's the problem. Fix it now.",
                    "Men are wired for mission. Create one. Even if it's just mastering a new skill or getting in peak physical condition. Your mission awaits."
                ],
                motivation: [
                    "Motivation is a myth. Discipline is real. Do the work whether you feel like it or not. Action creates motivation, not the other way around.",
                    "Your biology determines your psychology. Low energy? Check: sleep (8 hours), water (1 gallon), movement (daily). Fix the machine first.",
                    "Break the cycle. Do 25 push-ups RIGHT NOW. Don't think, just act. Motion creates emotion. Report back when done."
                ],
                default: [
                    "I hear you. Now, what's the ACTION you're going to take? Emotion is data, not a directive.",
                    "A man's power is in his response. How will you respond to this situation with integrity and strength?",
                    "Let's get practical. What's one concrete step you can take in the next hour to move forward?",
                    "Your mind follows your body. Get physical first - walk, lift, move. Then we'll address the mental."
                ]
            };

            window.sendMessage = function() {
                const message = userInput.value.trim();
                if (!message) return;

                // Add user message
                addMessage(message, 'user');
                userInput.value = '';

                // Show typing indicator
                typingIndicator.style.display = 'block';
                chatContainer.scrollTop = chatContainer.scrollHeight;

                // AI response after delay
                setTimeout(function() {
                    typingIndicator.style.display = 'none';
                    const aiResponse = getAIResponse(message);
                    addMessage(aiResponse, 'ai');
                    
                    // Randomly increase stats on some responses
                    if (Math.random() > 0.7) {
                        increaseRandomStat();
                    }
                }, 1500);
            };

            window.quickAction = function(type) {
                const messages = {
                    breakup: "My relationship ended and I'm struggling to move on.",
                    failure: "I experienced a major career setback and feel defeated.",
                    lonely: "I feel isolated and don't have meaningful connections.",
                    purpose: "I've lost my sense of direction and purpose in life.",
                    motivation: "I can't find the drive to accomplish anything meaningful."
                };
                
                userInput.value = messages[type];
                sendMessage();
            };

            window.handleKeyPress = function(event) {
                if (event.key === 'Enter') {
                    sendMessage();
                }
            };

            function addMessage(text, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message ' + sender + '-message';
                
                const timestamp = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                
                messageDiv.innerHTML = text +
                    '<div class="timestamp">' + timestamp + '</div>';
                
                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            function getAIResponse(userMessage) {
                const lowerMessage = userMessage.toLowerCase();
                let responseType = 'default';

                // Determine response type based on keywords
                if (lowerMessage.includes('breakup') || lowerMessage.includes('ex') || lowerMessage.includes('left me') || lowerMessage.includes('girl') || lowerMessage.includes('relationship')) {
                    responseType = 'breakup';
                } else if (lowerMessage.includes('fail') || lowerMessage.includes('job') || lowerMessage.includes('career') || lowerMessage.includes('business') || lowerMessage.includes('setback')) {
                    responseType = 'failure';
                } else if (lowerMessage.includes('lonely') || lowerMessage.includes('alone') || lowerMessage.includes('friend') || lowerMessage.includes('isolat') || lowerMessage.includes('connection')) {
                    responseType = 'lonely';
                } else if (lowerMessage.includes('purpose') || lowerMessage.includes('meaning') || lowerMessage.includes('direction') || lowerMessage.includes('lost')) {
                    responseType = 'purpose';
                } else if (lowerMessage.includes('motivat') || lowerMessage.includes('energy') || lowerMessage.includes('tired') || lowerMessage.includes('lazy') || lowerMessage.includes('drive')) {
                    responseType = 'motivation';
                }

                const responses = aiResponses[responseType];
                return responses[Math.floor(Math.random() * responses.length)];
            }

            function increaseRandomStat() {
                const stats = ['strength', 'resilience', 'focus'];
                const randomStat = stats[Math.floor(Math.random() * stats.length)];
                
                if (userStats[randomStat] < 10) {
                    userStats[randomStat]++;
                    updateStatsDisplay();
                    
                    // Show a brief notification
                    const notification = document.createElement('div');
                    notification.className = 'message ai-message';
                    notification.innerHTML = '💪 ' + randomStat.toUpperCase() + ' increased to Level ' + userStats[randomStat] + '!';
                    chatContainer.appendChild(notification);
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                }
            }

            function updateStatsDisplay() {
                strengthLevel.textContent = 'Level ' + userStats.strength;
                resilienceLevel.textContent = 'Level ' + userStats.resilience;
                focusLevel.textContent = 'Level ' + userStats.focus;
            }

            // Add initial welcome message after a delay
            setTimeout(function() {
                addMessage("I operate on three principles: 1) Action over analysis 2) Discipline over motivation 3) Progress over perfection. Ready to level up?", 'ai');
            }, 2000);
            
            // Prevent form submission on enter in input field
            userInput.addEventListener('keydown', function(e) {
                if (e.keyCode === 13) {
                    e.preventDefault();
                }
            });
        })();
    </script>
</body>
</html>